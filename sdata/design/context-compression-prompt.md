您的任务是创建一个全面、详细的整个对话摘要，捕捉无缝继续工作所需的所有基本信息，确保不丢失任何上下文。此摘要将用于压缩对话，同时保留关键的技术细节、决策和进展。

## 最近上下文分析
特别关注导致触发此摘要的最新代理命令和工具执行。包括：
- **最后代理命令**：刚刚执行了哪些具体操作/工具
- **工具结果**：最近工具调用的关键结果（如果很长则截断，但保留基本信息）
- **即时状态**：摘要前系统正在做什么
- **触发上下文**：什么导致令牌预算超限

## 分析过程
在提供最终摘要之前，将您的分析包裹在 `<analysis>` 标签中以系统组织思路：
1. **时间顺序回顾**：按时间顺序浏览对话，识别关键阶段和过渡
2. **意图映射**：提取所有显式和隐式的用户请求、目标和期望
3. **技术清单**：记录所有提到的技术概念、工具、框架和架构决策
4. **代码考古**：记录所有讨论或修改的文件、函数和代码模式
5. **进展评估**：评估已完成与待完成的工作
6. **上下文验证**：确保捕获所有继续工作所需的关键信息
7. **最近命令分析**：记录最近操作中的具体代理命令和工具结果

## 摘要结构
您的摘要必须按顺序包含以下部分，遵循以下确切格式：

<analysis>
[时间顺序回顾：浏览对话阶段：初始请求 → 探索 → 实现 → 调试 → 当前状态]
[意图映射：列出每个显式用户请求及其消息上下文]
[技术清单：记录所有提到的技术、模式和决策]
[代码考古：记录讨论的每个文件、函数和代码变更]
[进展评估：已完成与待完成的工作及其具体状态]
[上下文验证：验证所有继续上下文已捕获]
[最近命令分析：最后执行的代理命令、工具结果（长则截断）、摘要前的即时状态]
</analysis>

<summary>
1. 对话概览：
- 主要目标：[所有显式用户请求和总体目标，包含确切引用]
- 会话上下文：[对话流程和关键阶段的高级叙述]
- 用户意图演变：[用户在对话过程中需求或方向的变化]

2. 技术基础：
- [核心技术 1]：[版本/详情和用途]
- [框架/库 2]：[配置和使用上下文]
- [架构模式 3]：[实现方法和理由]
- [环境详情 4]：[设置细节和约束]

3. 代码库状态：
- [文件名称 1]：
  - 目的：[为什么此文件对项目重要]
  - 当前状态：[最近变更或修改的摘要]
  - 关键代码段：[重要函数/类及其简要解释]
  - 依赖关系：[此文件如何关联其他组件]
- [文件名称 2]：
  - 目的：[在项目中的角色]
  - 当前状态：[修改状态]
  - 关键代码段：[关键代码块]
- [根据需要添加更多文件]

4. 问题解决：
- 遇到的问题：[技术问题、错误或面临的挑战]
- 实施的解决方案：[如何解决问题及其理由]
- 调试上下文：[正在进行的故障排除努力或已知问题]
- 经验教训：[发现的重要见解或模式]

5. 进度跟踪：
- 已完成任务：[已成功实现的任务及其状态指示器]
- 部分完成工作：[进行中的任务及其当前完成状态]
- 已验证结果：[通过测试确认工作的功能或代码]

6. 活动工作状态：
- 当前焦点：[最近消息中正在处理的确切内容]
- 最近上下文：[最近几次对话交流的详细描述]
- 工作代码：[最近修改或讨论的代码片段]
- 即时上下文：[摘要前正在处理的特定问题或功能]

7. 最近操作：
- 最后代理命令：[摘要前刚刚执行的具体工具/操作，包含确切命令名称]
- 工具结果摘要：[最近工具执行的关键结果 - 长结果截断但保留基本信息]
- 摘要前状态：[令牌预算超限时代理正在做什么]
- 操作上下文：[为什么执行这些特定命令及其与用户目标的关系]

8. 继续计划：
- [待完成任务 1]：[详情和具体后续步骤，包含逐字引用]
- [待完成任务 2]：[要求和继续上下文]
- [优先级信息]：[哪些任务最紧急或逻辑上连续]
- [下一步行动]：[立即下一步，包含最近消息中的直接引用]
</summary>

## 质量指南
- **精确性**：包含确切的文件名、函数名、变量名和技术术语
- **完整性**：捕获继续工作所需的所有上下文，无需重新阅读完整对话
- **清晰性**：为需要精确接续对话的人编写
- **逐字准确性**：对任务规范和最近工作上下文使用直接引用
- **技术深度**：包含足够细节以理解复杂技术决策和代码模式
- **逻辑流程**：以逐步构建理解的方式呈现信息

此摘要应作为全面的交接文档，能够无缝继续所有活动工作流，同时保留原始对话的完整技术和上下文丰富性。